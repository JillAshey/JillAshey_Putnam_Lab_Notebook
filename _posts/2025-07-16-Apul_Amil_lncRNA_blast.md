---
layout: post
title: e5 lncRNA blast
date: '2025-07-16'
categories: Analysis
tags: [Bioinformatics]
projects: 
---

Blast Apul lncRNAs and Amil lncRNAs to compare 

- Amil [lncRNAs](https://github.com/urol-e5/deep-dive/blob/main/D-Apul/output/22-Apul-Amil-genome/Amil_lncRNA.fasta) -- generated by NCBI

- Apul [lncRNAs](https://github.com/urol-e5/deep-dive/blob/main/D-Apul/output/05.33-lncRNA-discovery/Apul_lncRNA.fasta)-- generated by e5 group 

```
grep -c ">" Amil_lncRNA.fasta 
6128
grep -c ">" Apul_lncRNA.fasta 
16206
```

`nano blast_acropora_lnc.sh`

```
#!/usr/bin/env bash
#SBATCH --export=NONE
#SBATCH --nodes=1 --ntasks-per-node=2
#SBATCH --partition=uri-cpu
#SBATCH --no-requeue
#SBATCH --mem=200GB
#SBATCH -t 100:00:00
#SBATCH --mail-type=BEGIN,END,FAIL #email you when job starts, stops and/or fails
#SBATCH -o slurm-%j.out
#SBATCH -e slurm-%j.error
#SBATCH -D /work/pi_hputnam_uri_edu/jillashey/e5/lnc_blast

# Load modules 
module load uri/main
module load BLAST+/2.15.0-gompi-2023a

cd /work/pi_hputnam_uri_edu/jillashey/e5/lnc_blast

echo "Making blast db" $(date)

makeblastdb -in Apul_lncRNA.fasta -out apul_lnc_db -dbtype nucl

echo "Db creation complete, blast Amil NCBI lncRNAs against Apul lnc db" $(date)

blastn -query Amil_lncRNA.fasta -db apul_lnc_db -out amil_apul_lncRNA_blastn.tab -evalue 1E-40 -num_threads 10 -max_hsps 1 -outfmt 6

blastn -query Amil_lncRNA.fasta -db apul_lnc_db -out amil_apul_lncRNA_max1target_blastn.tab -evalue 1E-40 -num_threads 10 -max_target_seqs 1 -max_hsps 1 -outfmt 6

echo "Blast complete" $(date)
```

Submitted batch job 40032396. Look at results 

```
echo "Number of hits of Amil lncRNAs to Apul lncRNAs?"
wc -l amil_apul_lncRNA_blastn.tab
134080 amil_apul_lncRNA_blastn.tab

echo "Number of hits (max 1 target) of Amil lncRNAs to Apul lncRNAs?"
wc -l amil_apul_lncRNA_max1target_blastn.tab
4108 amil_apul_lncRNA_max1target_blastn.tab
```

Look at unique entries for columns 1 and 2

```
cut -f1 amil_apul_lncRNA_blastn.tab | sort | uniq | wc -l
4108

cut -f2 amil_apul_lncRNA_blastn.tab | sort | uniq | wc -l
8512

cut -f1 amil_apul_lncRNA_max1target_blastn.tab | sort | uniq | wc -l
4108

cut -f2 amil_apul_lncRNA_max1target_blastn.tab | sort | uniq | wc -l
1354
```

Look at unique entries for column 1 and 2 together 

```
cut -f1,2 amil_apul_lncRNA_blastn.tab | sort | uniq | wc -l
131384

cut -f1,2 amil_apul_lncRNA_max1target_blastn.tab | sort | uniq | wc -l
4108
```